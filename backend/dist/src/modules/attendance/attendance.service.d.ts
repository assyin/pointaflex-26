import { PrismaService } from '../../database/prisma.service';
import { CreateAttendanceDto } from './dto/create-attendance.dto';
import { WebhookAttendanceDto } from './dto/webhook-attendance.dto';
import { WebhookStateDto, WebhookStateResponseDto } from './dto/webhook-state.dto';
import { CorrectAttendanceDto } from './dto/correct-attendance.dto';
import { ValidateAttendanceDto, ValidationAction } from './dto/validate-attendance.dto';
import { AttendanceType } from '@prisma/client';
import { Decimal } from '@prisma/client/runtime/library';
export declare class AttendanceService {
    private prisma;
    constructor(prisma: PrismaService);
    private roundOvertimeHours;
    private getOvertimeRate;
    private isNightShiftTime;
    private createAutoOvertime;
    create(tenantId: string, createAttendanceDto: CreateAttendanceDto): Promise<({
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            userId: string;
            matricule: string;
            photo: string;
            department: {
                id: string;
                managerId: string;
            };
            site: {
                id: string;
                siteManagers: {
                    managerId: string;
                }[];
            };
        };
        site: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            phone: string | null;
            address: string | null;
            timezone: string | null;
            city: string | null;
            tenantId: string;
            code: string | null;
            name: string;
            departmentId: string | null;
            managerId: string | null;
            latitude: Decimal | null;
            longitude: Decimal | null;
            workingDays: import("@prisma/client/runtime/library").JsonValue | null;
        };
        device: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            name: string;
            isActive: boolean;
            siteId: string | null;
            deviceId: string;
            ipAddress: string | null;
            deviceType: import(".prisma/client").$Enums.DeviceType;
            apiKey: string | null;
            apiKeyHash: string | null;
            apiKeyLastRotation: Date | null;
            apiKeyExpiresAt: Date | null;
            allowedIPs: string[];
            enforceIPWhitelist: boolean;
            lastSync: Date | null;
            lastHeartbeat: Date | null;
            heartbeatInterval: number;
            totalSyncs: number;
            failedSyncs: number;
            avgResponseTime: number | null;
        };
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    }) | {
        _debounced: boolean;
        _debounceInfo: {
            reason: string;
            message: string;
            previousPunchId: string;
            previousPunchTime: Date;
            configuredTolerance: number;
        };
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            matricule: string;
            photo: string;
        };
        site: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            phone: string | null;
            address: string | null;
            timezone: string | null;
            city: string | null;
            tenantId: string;
            code: string | null;
            name: string;
            departmentId: string | null;
            managerId: string | null;
            latitude: Decimal | null;
            longitude: Decimal | null;
            workingDays: import("@prisma/client/runtime/library").JsonValue | null;
        };
        device: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            name: string;
            isActive: boolean;
            siteId: string | null;
            deviceId: string;
            ipAddress: string | null;
            deviceType: import(".prisma/client").$Enums.DeviceType;
            apiKey: string | null;
            apiKeyHash: string | null;
            apiKeyLastRotation: Date | null;
            apiKeyExpiresAt: Date | null;
            allowedIPs: string[];
            enforceIPWhitelist: boolean;
            lastSync: Date | null;
            lastHeartbeat: Date | null;
            heartbeatInterval: number;
            totalSyncs: number;
            failedSyncs: number;
            avgResponseTime: number | null;
        };
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    }>;
    determinePunchType(tenantId: string, employeeId: string, punchTimeStr: string, deviceId?: string, apiKey?: string): Promise<{
        type: 'IN' | 'OUT';
        method: 'ALTERNATION' | 'SHIFT_BASED' | 'TIME_BASED';
        confidence: 'HIGH' | 'MEDIUM' | 'LOW';
        reason: string;
        debug?: any;
        isAmbiguous?: boolean;
        validationStatus?: 'NONE' | 'PENDING_VALIDATION';
        ambiguityReason?: string;
    }>;
    getPunchCountForDay(tenantId: string, employeeId: string, date: string, deviceId?: string, apiKey?: string, punchTime?: string): Promise<{
        count: number;
        forceType: any;
        reason?: undefined;
        openSessionFrom?: undefined;
        nightShiftConfig?: undefined;
    } | {
        count: number;
        forceType: string;
        reason: string;
        openSessionFrom: Date;
        nightShiftConfig: {
            nightShiftEnd: string;
            isNightShiftEmployee: boolean;
            inHour: number;
        };
    }>;
    handleWebhookFast(tenantId: string, deviceId: string, webhookData: WebhookAttendanceDto, apiKey?: string): Promise<{
        status: string;
        reason: string;
        message: string;
        existingAttendanceId: string;
        attendanceId?: undefined;
        lastPunchTime?: undefined;
        lastPunchType?: undefined;
        configuredTolerance?: undefined;
        success?: undefined;
        employee?: undefined;
        timestamp?: undefined;
        type?: undefined;
        detectionMethod?: undefined;
    } | {
        status: string;
        reason: string;
        message: string;
        attendanceId: string;
        lastPunchTime: Date;
        lastPunchType: import(".prisma/client").$Enums.AttendanceType;
        configuredTolerance: number;
        existingAttendanceId?: undefined;
        success?: undefined;
        employee?: undefined;
        timestamp?: undefined;
        type?: undefined;
        detectionMethod?: undefined;
    } | {
        success: boolean;
        attendanceId: string;
        employee: {
            id: any;
            matricule: any;
            name: string;
        };
        timestamp: string;
        type: import(".prisma/client").$Enums.AttendanceType;
        detectionMethod: "ALTERNATION" | "SHIFT_BASED" | "TIME_BASED";
        status?: undefined;
        reason?: undefined;
        message?: undefined;
        existingAttendanceId?: undefined;
        lastPunchTime?: undefined;
        lastPunchType?: undefined;
        configuredTolerance?: undefined;
    }>;
    handleWebhook(tenantId: string, deviceId: string, webhookData: WebhookAttendanceDto, apiKey?: string): Promise<({
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            userId: string;
            matricule: string;
            department: {
                id: string;
                managerId: string;
            };
            site: {
                id: string;
                siteManagers: {
                    managerId: string;
                }[];
            };
        };
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    }) | {
        status: string;
        reason: string;
        message: string;
        existingAttendanceId: string;
        attendanceId?: undefined;
        lastPunchTime?: undefined;
        lastPunchType?: undefined;
        configuredTolerance?: undefined;
    } | {
        status: string;
        reason: string;
        message: string;
        attendanceId: string;
        lastPunchTime: Date;
        lastPunchType: import(".prisma/client").$Enums.AttendanceType;
        configuredTolerance: number;
        existingAttendanceId?: undefined;
    }>;
    findAll(tenantId: string, filters?: {
        employeeId?: string;
        siteId?: string;
        startDate?: string;
        endDate?: string;
        hasAnomaly?: boolean;
        type?: AttendanceType;
        page?: number;
        limit?: number;
    }, userId?: string, userPermissions?: string[]): Promise<{
        hoursWorked: number;
        effectiveShift: any;
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            matricule: string;
            photo: string;
            siteId: string;
            departmentId: string;
            currentShift: {
                id: string;
                code: string;
                name: string;
                startTime: string;
                endTime: string;
            };
            department: {
                id: string;
                name: string;
            };
        };
        siteId: string;
        site: {
            id: string;
            code: string;
            name: string;
        };
        latitude: Decimal;
        longitude: Decimal;
        employeeId: string;
        deviceId: string;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string;
        anomalyNote: string;
        isCorrected: boolean;
        correctedBy: string;
        correctedAt: Date;
        correctionNote: string;
        lateMinutes: number;
        earlyLeaveMinutes: number;
        overtimeMinutes: number;
        needsApproval: boolean;
        approvalStatus: string;
        approvedBy: string;
        approvedAt: Date;
        rawData: import("@prisma/client/runtime/library").JsonValue;
        generatedBy: string;
        isGenerated: boolean;
        device: {
            id: string;
            name: string;
            deviceId: string;
            deviceType: import(".prisma/client").$Enums.DeviceType;
        };
    }[] | {
        data: {
            hoursWorked: number;
            effectiveShift: any;
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            employee: {
                id: string;
                firstName: string;
                lastName: string;
                matricule: string;
                photo: string;
                siteId: string;
                departmentId: string;
                currentShift: {
                    id: string;
                    code: string;
                    name: string;
                    startTime: string;
                    endTime: string;
                };
                department: {
                    id: string;
                    name: string;
                };
            };
            siteId: string;
            site: {
                id: string;
                code: string;
                name: string;
            };
            latitude: Decimal;
            longitude: Decimal;
            employeeId: string;
            deviceId: string;
            timestamp: Date;
            type: import(".prisma/client").$Enums.AttendanceType;
            method: import(".prisma/client").$Enums.DeviceType;
            hasAnomaly: boolean;
            anomalyType: string;
            anomalyNote: string;
            isCorrected: boolean;
            correctedBy: string;
            correctedAt: Date;
            correctionNote: string;
            lateMinutes: number;
            earlyLeaveMinutes: number;
            overtimeMinutes: number;
            needsApproval: boolean;
            approvalStatus: string;
            approvedBy: string;
            approvedAt: Date;
            rawData: import("@prisma/client/runtime/library").JsonValue;
            generatedBy: string;
            isGenerated: boolean;
            device: {
                id: string;
                name: string;
                deviceId: string;
                deviceType: import(".prisma/client").$Enums.DeviceType;
            };
        }[];
        meta: {
            total: number;
            page: number;
            limit: number;
            totalPages: number;
        };
    }>;
    remove(tenantId: string, id: string, userId?: string, userPermissions?: string[]): Promise<{
        success: boolean;
        message: string;
    }>;
    findOne(tenantId: string, id: string): Promise<{
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            matricule: string;
            photo: string;
            position: string;
            department: {
                id: string;
                createdAt: Date;
                updatedAt: Date;
                tenantId: string;
                code: string | null;
                name: string;
                description: string | null;
                managerId: string | null;
            };
            team: {
                id: string;
                createdAt: Date;
                updatedAt: Date;
                tenantId: string;
                code: string;
                name: string;
                description: string | null;
                managerId: string | null;
                rotationEnabled: boolean;
                rotationCycleDays: number | null;
            };
        };
        site: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            phone: string | null;
            address: string | null;
            timezone: string | null;
            city: string | null;
            tenantId: string;
            code: string | null;
            name: string;
            departmentId: string | null;
            managerId: string | null;
            latitude: Decimal | null;
            longitude: Decimal | null;
            workingDays: import("@prisma/client/runtime/library").JsonValue | null;
        };
        device: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            name: string;
            isActive: boolean;
            siteId: string | null;
            deviceId: string;
            ipAddress: string | null;
            deviceType: import(".prisma/client").$Enums.DeviceType;
            apiKey: string | null;
            apiKeyHash: string | null;
            apiKeyLastRotation: Date | null;
            apiKeyExpiresAt: Date | null;
            allowedIPs: string[];
            enforceIPWhitelist: boolean;
            lastSync: Date | null;
            lastHeartbeat: Date | null;
            heartbeatInterval: number;
            totalSyncs: number;
            failedSyncs: number;
            avgResponseTime: number | null;
        };
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    }>;
    correctAttendance(tenantId: string, id: string, correctionDto: CorrectAttendanceDto, userId?: string, userPermissions?: string[]): Promise<{
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            userId: string;
            matricule: string;
        };
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    }>;
    private isManagerCorrectingOthersAttendance;
    private requiresApproval;
    private notifyManagersOfAnomaly;
    private notifyEmployeeOfCorrection;
    private notifyEmployeeOfManagerCorrection;
    private notifyManagersOfApprovalRequired;
    getAnomalies(tenantId: string, date?: string, userId?: string, userPermissions?: string[]): Promise<{
        score: number;
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            matricule: string;
            photo: string;
            department: {
                id: string;
                name: string;
            };
            site: {
                id: string;
                name: string;
            };
        };
        site: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            phone: string | null;
            address: string | null;
            timezone: string | null;
            city: string | null;
            tenantId: string;
            code: string | null;
            name: string;
            departmentId: string | null;
            managerId: string | null;
            latitude: Decimal | null;
            longitude: Decimal | null;
            workingDays: import("@prisma/client/runtime/library").JsonValue | null;
        };
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    }[]>;
    getAnomaliesPaginated(tenantId: string, filters: {
        startDate?: string;
        endDate?: string;
        employeeId?: string;
        departmentId?: string;
        siteId?: string;
        anomalyType?: string;
        isCorrected?: boolean;
        page?: number;
        limit?: number;
    }, userId?: string, userPermissions?: string[]): Promise<{
        data: ({
            employee: {
                id: string;
                firstName: string;
                lastName: string;
                matricule: string;
                photo: string;
                department: {
                    id: string;
                    name: string;
                };
                site: {
                    id: string;
                    name: string;
                };
            };
            site: {
                id: string;
                createdAt: Date;
                updatedAt: Date;
                phone: string | null;
                address: string | null;
                timezone: string | null;
                city: string | null;
                tenantId: string;
                code: string | null;
                name: string;
                departmentId: string | null;
                managerId: string | null;
                latitude: Decimal | null;
                longitude: Decimal | null;
                workingDays: import("@prisma/client/runtime/library").JsonValue | null;
            };
        } & {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            siteId: string | null;
            latitude: Decimal | null;
            longitude: Decimal | null;
            employeeId: string;
            deviceId: string | null;
            timestamp: Date;
            type: import(".prisma/client").$Enums.AttendanceType;
            method: import(".prisma/client").$Enums.DeviceType;
            hasAnomaly: boolean;
            anomalyType: string | null;
            anomalyNote: string | null;
            isCorrected: boolean;
            correctedBy: string | null;
            correctedAt: Date | null;
            correctionNote: string | null;
            hoursWorked: Decimal | null;
            lateMinutes: number | null;
            earlyLeaveMinutes: number | null;
            overtimeMinutes: number | null;
            needsApproval: boolean;
            approvalStatus: string | null;
            approvedBy: string | null;
            approvedAt: Date | null;
            rawData: import("@prisma/client/runtime/library").JsonValue | null;
            generatedBy: string | null;
            isGenerated: boolean;
            isAmbiguous: boolean;
            ambiguityReason: string | null;
            validationStatus: import(".prisma/client").$Enums.ValidationStatus;
            validatedBy: string | null;
            validatedAt: Date | null;
            escalationLevel: number;
            terminalState: number | null;
            source: string;
            detectionMethod: string | null;
        })[];
        meta: {
            total: number;
            page: number;
            limit: number;
            totalPages: number;
        };
    }>;
    getDailyReport(tenantId: string, date: string): Promise<{
        date: string;
        totalRecords: number;
        uniqueEmployees: number;
        lateEntries: number;
        anomalies: number;
    }>;
    private validateBreakPunch;
    private calculateMetrics;
    private getScheduleWithFallback;
    private validateScheduleOrShift;
    private parseTimeString;
    private detectDoubleInImproved;
    private generateDoubleInCorrectionSuggestion;
    private analyzeDoubleInPattern;
    private detectMissingInImproved;
    private generateMissingInTimeSuggestion;
    private detectMissingOutImproved;
    private getTimezoneOffset;
    private isNightShift;
    private generateMissingOutTimeSuggestion;
    private analyzeMissingOutPattern;
    private analyzeMissingInPattern;
    private detectAnomalies;
    approveCorrection(tenantId: string, id: string, approvedBy: string, approved: boolean, comment?: string): Promise<{
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            userId: string;
        };
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    }>;
    getPresenceRate(tenantId: string, employeeId: string, startDate: Date, endDate: Date): Promise<{
        presenceRate: number;
        totalDays: number;
        presentDays: number;
        absentDays: number;
        leaveDays: number;
        recoveryDays: number;
    }>;
    getPunctualityRate(tenantId: string, employeeId: string, startDate: Date, endDate: Date): Promise<{
        punctualityRate: number;
        totalEntries: number;
        onTimeEntries: number;
        lateEntries: number;
        averageLateMinutes: number;
    }>;
    getTrends(tenantId: string, employeeId: string, startDate: Date, endDate: Date): Promise<{
        dailyTrends: Array<{
            date: string;
            lateCount: number;
            absentCount: number;
            earlyLeaveCount: number;
            anomaliesCount: number;
        }>;
        weeklyTrends: Array<{
            week: string;
            lateCount: number;
            absentCount: number;
            earlyLeaveCount: number;
            anomaliesCount: number;
        }>;
    }>;
    detectRecurringAnomalies(tenantId: string, employeeId: string, days?: number): Promise<Array<{
        type: string;
        count: number;
        lastOccurrence: Date;
        frequency: string;
    }>>;
    bulkCorrectAttendance(tenantId: string, bulkDto: {
        attendances: Array<{
            attendanceId: string;
            correctedTimestamp?: string;
            correctionNote?: string;
        }>;
        generalNote: string;
        correctedBy: string;
        forceApproval?: boolean;
    }): Promise<{
        total: number;
        success: number;
        failed: number;
        results: any[];
        errors: any[];
    }>;
    exportAnomalies(tenantId: string, filters: {
        startDate?: string;
        endDate?: string;
        employeeId?: string;
        anomalyType?: string;
    }, format: 'csv' | 'excel'): Promise<string | {
        date: string;
        time: string;
        employee: string;
        matricule: string;
        department: string;
        site: string;
        anomalyType: string;
        note: string;
        status: string;
        correctedBy: string;
        correctedAt: string;
    }[]>;
    exportAttendance(tenantId: string, filters: {
        startDate?: string;
        endDate?: string;
        employeeId?: string;
        departmentId?: string;
        siteId?: string;
        type?: string;
    }, format: 'csv' | 'excel', userId?: string, userPermissions?: string[]): Promise<string | Buffer>;
    getAnomaliesDashboard(tenantId: string, startDate: Date, endDate: Date, userId?: string, userPermissions?: string[]): Promise<{
        summary: {
            total: number;
            corrected: number;
            pending: number;
            correctionRate: number;
        };
        byType: any[];
        byEmployee: any[];
        byDay: any[];
    }>;
    private getEmptyDashboard;
    getAnomalyPriority(anomalyType: string | null): number;
    calculateAnomalyScore(tenantId: string, employeeId: string, anomalyType: string | null, timestamp: Date, hasJustification?: boolean): Promise<number>;
    getCorrectionHistory(tenantId: string, attendanceId: string): Promise<any[]>;
    bulkCorrect(tenantId: string, corrections: Array<{
        attendanceId: string;
        correctedTimestamp?: string;
        correctionNote?: string;
    }>, generalNote: string, correctedBy: string, userId?: string, userPermissions?: string[]): Promise<{
        total: number;
        success: number;
        failed: number;
        results: any[];
        errors: any[];
    }>;
    getAnomaliesAnalytics(tenantId: string, startDate: string, endDate: string, filters?: {
        employeeId?: string;
        departmentId?: string;
        siteId?: string;
        anomalyType?: string;
    }): Promise<{
        summary: {
            total: number;
            corrected: number;
            pending: number;
            avgResolutionTimeHours: number;
        };
        byType: {
            type: string;
            count: number;
        }[];
        byEmployee: {
            employeeId: string;
            employeeName: string;
            matricule: string;
            count: number;
        }[];
        byDepartment: {
            siteId: string;
            count: number;
        }[];
        trends: {
            date: Date;
            count: number;
        }[];
        dayOfWeekPatterns: {
            dayOfWeek: number;
            dayName: string;
            count: number;
        }[];
    }>;
    getMonthlyAnomaliesReport(tenantId: string, year: number, month: number): Promise<{
        period: {
            year: number;
            month: number;
        };
        summary: {
            total: number;
            corrected: number;
            pending: number;
        };
        byDepartment: any[];
    }>;
    getHighAnomalyRateEmployees(tenantId: string, threshold?: number, days?: number): Promise<{
        employeeId: string;
        employeeName: string;
        matricule: string;
        department: string;
        anomalyCount: number;
        recommendation: string;
    }[]>;
    private detectHolidayWork;
    private generateRecommendation;
    createTechnicalAnomaly(tenantId: string, employeeId: string, data: {
        subType: string;
        description: string;
        severity?: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
        deviceId?: string;
        attendanceId?: string;
        scheduleId?: string;
        occurredAt?: Date;
        metadata?: any;
    }): Promise<{
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        description: string;
        employeeId: string;
        status: string;
        deviceId: string | null;
        type: string;
        occurredAt: Date;
        severity: string;
        subType: string | null;
        detectedAt: Date;
        metadata: import("@prisma/client/runtime/library").JsonValue | null;
        resolvedAt: Date | null;
        resolution: string | null;
        notifiedAt: Date | null;
        attendanceId: string | null;
        scheduleId: string | null;
        resolvedBy: string | null;
    }>;
    detectDeviceFailures(tenantId: string, deviceId: string): Promise<void>;
    detectOfflineDevices(tenantId: string): Promise<void>;
    resolveAnomaly(anomalyId: string, resolvedBy: string, resolution: string): Promise<{
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        description: string;
        employeeId: string;
        status: string;
        deviceId: string | null;
        type: string;
        occurredAt: Date;
        severity: string;
        subType: string | null;
        detectedAt: Date;
        metadata: import("@prisma/client/runtime/library").JsonValue | null;
        resolvedAt: Date | null;
        resolution: string | null;
        notifiedAt: Date | null;
        attendanceId: string | null;
        scheduleId: string | null;
        resolvedBy: string | null;
    }>;
    getOpenTechnicalAnomalies(tenantId: string, filters?: {
        employeeId?: string;
        deviceId?: string;
        severity?: string;
        limit?: number;
    }): Promise<({
        employee: {
            user: {
                email: string;
                firstName: string;
                lastName: string;
            };
            department: {
                id: string;
                createdAt: Date;
                updatedAt: Date;
                tenantId: string;
                code: string | null;
                name: string;
                description: string | null;
                managerId: string | null;
            };
        } & {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            email: string | null;
            phone: string | null;
            address: string | null;
            tenantId: string;
            firstName: string;
            lastName: string;
            isActive: boolean;
            userId: string | null;
            matricule: string;
            dateOfBirth: Date | null;
            photo: string | null;
            civilite: string | null;
            situationFamiliale: string | null;
            nombreEnfants: number | null;
            cnss: string | null;
            cin: string | null;
            ville: string | null;
            rib: string | null;
            region: string | null;
            categorie: string | null;
            position: string;
            positionId: string | null;
            hireDate: Date;
            contractType: string | null;
            siteId: string | null;
            departmentId: string | null;
            teamId: string | null;
            currentShiftId: string | null;
            fingerprintData: string | null;
            faceData: string | null;
            rfidBadge: string | null;
            qrCode: string | null;
            pinCode: string | null;
            isEligibleForOvertime: boolean;
            maxOvertimeHoursPerMonth: Decimal | null;
            maxOvertimeHoursPerWeek: Decimal | null;
            overtimeEligibilityNotes: string | null;
        };
        schedule: {
            shift: {
                id: string;
                createdAt: Date;
                updatedAt: Date;
                tenantId: string;
                code: string;
                name: string;
                startTime: string;
                endTime: string;
                breakStartTime: string | null;
                breakDuration: number;
                isNightShift: boolean;
                color: string | null;
            };
        } & {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            teamId: string | null;
            employeeId: string;
            shiftId: string;
            date: Date;
            customStartTime: string | null;
            customEndTime: string | null;
            notes: string | null;
            status: import(".prisma/client").$Enums.ScheduleStatus;
            publishedAt: Date | null;
            cancelledAt: Date | null;
            suspendedByLeaveId: string | null;
            suspendedAt: Date | null;
        };
        device: {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            name: string;
            isActive: boolean;
            siteId: string | null;
            deviceId: string;
            ipAddress: string | null;
            deviceType: import(".prisma/client").$Enums.DeviceType;
            apiKey: string | null;
            apiKeyHash: string | null;
            apiKeyLastRotation: Date | null;
            apiKeyExpiresAt: Date | null;
            allowedIPs: string[];
            enforceIPWhitelist: boolean;
            lastSync: Date | null;
            lastHeartbeat: Date | null;
            heartbeatInterval: number;
            totalSyncs: number;
            failedSyncs: number;
            avgResponseTime: number | null;
        };
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        description: string;
        employeeId: string;
        status: string;
        deviceId: string | null;
        type: string;
        occurredAt: Date;
        severity: string;
        subType: string | null;
        detectedAt: Date;
        metadata: import("@prisma/client/runtime/library").JsonValue | null;
        resolvedAt: Date | null;
        resolution: string | null;
        notifiedAt: Date | null;
        attendanceId: string | null;
        scheduleId: string | null;
        resolvedBy: string | null;
    })[]>;
    getPendingValidations(tenantId: string, userId: string, filters?: {
        employeeId?: string;
        dateFrom?: string;
        dateTo?: string;
        limit?: number;
    }): Promise<({
        employee: {
            id: string;
            firstName: string;
            lastName: string;
            matricule: string;
            currentShift: {
                name: string;
                startTime: string;
                endTime: string;
                isNightShift: boolean;
            };
        };
        site: {
            name: string;
        };
        device: {
            name: string;
        };
    } & {
        id: string;
        createdAt: Date;
        updatedAt: Date;
        tenantId: string;
        siteId: string | null;
        latitude: Decimal | null;
        longitude: Decimal | null;
        employeeId: string;
        deviceId: string | null;
        timestamp: Date;
        type: import(".prisma/client").$Enums.AttendanceType;
        method: import(".prisma/client").$Enums.DeviceType;
        hasAnomaly: boolean;
        anomalyType: string | null;
        anomalyNote: string | null;
        isCorrected: boolean;
        correctedBy: string | null;
        correctedAt: Date | null;
        correctionNote: string | null;
        hoursWorked: Decimal | null;
        lateMinutes: number | null;
        earlyLeaveMinutes: number | null;
        overtimeMinutes: number | null;
        needsApproval: boolean;
        approvalStatus: string | null;
        approvedBy: string | null;
        approvedAt: Date | null;
        rawData: import("@prisma/client/runtime/library").JsonValue | null;
        generatedBy: string | null;
        isGenerated: boolean;
        isAmbiguous: boolean;
        ambiguityReason: string | null;
        validationStatus: import(".prisma/client").$Enums.ValidationStatus;
        validatedBy: string | null;
        validatedAt: Date | null;
        escalationLevel: number;
        terminalState: number | null;
        source: string;
        detectionMethod: string | null;
    })[]>;
    validateAmbiguousPunch(tenantId: string, userId: string, dto: ValidateAttendanceDto): Promise<{
        success: boolean;
        attendance: {
            employee: {
                firstName: string;
                lastName: string;
                matricule: string;
            };
        } & {
            id: string;
            createdAt: Date;
            updatedAt: Date;
            tenantId: string;
            siteId: string | null;
            latitude: Decimal | null;
            longitude: Decimal | null;
            employeeId: string;
            deviceId: string | null;
            timestamp: Date;
            type: import(".prisma/client").$Enums.AttendanceType;
            method: import(".prisma/client").$Enums.DeviceType;
            hasAnomaly: boolean;
            anomalyType: string | null;
            anomalyNote: string | null;
            isCorrected: boolean;
            correctedBy: string | null;
            correctedAt: Date | null;
            correctionNote: string | null;
            hoursWorked: Decimal | null;
            lateMinutes: number | null;
            earlyLeaveMinutes: number | null;
            overtimeMinutes: number | null;
            needsApproval: boolean;
            approvalStatus: string | null;
            approvedBy: string | null;
            approvedAt: Date | null;
            rawData: import("@prisma/client/runtime/library").JsonValue | null;
            generatedBy: string | null;
            isGenerated: boolean;
            isAmbiguous: boolean;
            ambiguityReason: string | null;
            validationStatus: import(".prisma/client").$Enums.ValidationStatus;
            validatedBy: string | null;
            validatedAt: Date | null;
            escalationLevel: number;
            terminalState: number | null;
            source: string;
            detectionMethod: string | null;
        };
        action: ValidationAction;
        message: string;
    }>;
    bulkValidateAmbiguousPunches(tenantId: string, userId: string, dtos: ValidateAttendanceDto[]): Promise<{
        success: boolean;
        validated: number;
        errors: number;
        results: any[];
        errorDetails: any[];
    }>;
    escalatePendingValidations(tenantId: string): Promise<{
        processed: number;
        escalated: number;
        escalations: any[];
        message: string;
        settings?: undefined;
    } | {
        processed: number;
        escalated: number;
        escalations: any[];
        settings: {
            level1Hours: number;
            level2Hours: number;
            level3Hours: number;
        };
        message?: undefined;
    }>;
    processTerminalPunch(tenantId: string, deviceId: string, webhookData: WebhookStateDto, apiKey?: string): Promise<WebhookStateResponseDto>;
}
